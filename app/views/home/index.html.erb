<h2>Day Schedules for <%= @selected_date.strftime('%m/%d/%Y') %></h2>

<div class="date-picker">
  <%= form_tag({ controller: 'home', action: 'index' }, method: 'get', id: 'date-form') do %>
    <%= label_tag :datepicker, 'Select a Date:' %>
    <%= date_field_tag :datepicker, @selected_date || Date.today, id: 'datepicker' %>
    <%= submit_tag 'Go' %>
  <% end %>
</div>


<table>
  <thead>
    <tr>
      <th>Time</th>
      <% @assets.each do |asset| %>
        <th>
          <%= asset.name %>
          <% Rails.logger.info "Here's the selected date:" %>
          <% Rails.logger.info @selected_date %>
          <% Rails.logger.info "@selected_date is a Date: #{@selected_date.is_a?(Date)}" %>
          <% Rails.logger.info "Here's the asset.id:" %>
          <% Rails.logger.info asset.id %>
          <%= link_to 'Reserve', reserve_asset_day_schedules_path(asset_id: asset.id, selected_date: @selected_date), class: 'reserve-button' %>
        </th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @time_slots.each do |time_slot| %>
      <tr>
        <td><%= time_slot %></td>
        <% @assets.each do |asset| %>
          <td>
            <% day_schedule = asset.day_schedules.find_by(asset_id: asset.id, day: @selected_date) %>
            <% if day_schedule %>
              <% reservation = day_schedule.reservations.find { |r| r.time_slot == time_slot } %>
              <%= reservation ? reservation.description : '-' %>
            <% else %>
              -
            <% end %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>